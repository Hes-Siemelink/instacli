Test case: Variables in nested for each

${family}:
  - name: Mary
    children:
      - name: Alice
  - name: Caroline
    children: [ ]
${allNames}: [ ]

# Get a list of all names
For each:
  ${parent} in: ${family}

  # Create name object for parent
  ${parentName}:
    - name: ${parent.name}

  # Create list of name objects for children
  For each:
    ${child} in: ${parent.children}
    Output:
      name: ${child.name}
  As: childNames

  # Add them to the list of all names
  Merge:
    - ${allNames}
    - ${parentName}
    - ${childNames}
  ${allNames}: ${output}


Assert equals:
  actual: ${allNames}
  expected:
    - name: Mary
    - name: Alice
    - name: Caroline
